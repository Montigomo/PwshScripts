
  
+++ mshta
++program
mshta.exe
++ arguments
+ for commands
'vbscript:Execute("CreateObject(""Wscript.Shell"").Run ""pwsh -NoLogo -Command """"& ''' + $commands + '''"""""", 0 : window.close")'
+ for script
'vbscript:Execute("CreateObject(""Wscript.Shell"").Run ""pwsh -NoLogo -File """" + $thisFileFullName + """""", 0 : window.close")'

++ supress error 
vbscript:Execute("On Error Resume Next : CreateObject(""Wscript.Shell"").Run ""pwsh -NoLogo -File """"D:\work\runi.ps1"""""", 0 : window.close")
vbscript:Execute("On Error Resume Next : CreateObject(""Wscript.Shell"").Run ""pwsh -NoLogo -File """"D:\_software\adobe\updater\cupter.ps1"""""", 0 : window.close")
vbscript:Execute("On Error Resume Next : CreateObject(""Wscript.Shell"").Run ""pwsh -NoLogo -File """"D:\_software\adobe\updater\cupter.ps1"""""", 0 : window.close")

+++ not worked (windows visible)

#$execCommand = '"C:\Program Files\PowerShell\7\pwsh.exe"';
#$execArguments = "-ExecutionPolicy Bypass -NoLogo -NonInteractive -WindowStyle Hidden -NoProfile -File $script -Verb RunAs"

$execCommand = "pwsh.exe"
$execArguments = -w Hidden -Command '& "D:\work\powershell\PwshScripts\Learning\Scheduled Tasks\run_invisible.ps1"'
-WindowStyle  Hidden -File "D:\work\powershell\PwshScripts\Learning\Scheduled Tasks\run_invisible.ps1"

